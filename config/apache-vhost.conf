<VirtualHost *:80>
  ServerName sustainablecorn.org
  ServerAlias www.sustainablecorn.org

  Redirect permanent / https://sustainablecorn.org/
</VirtualHost>

<VirtualHost *:443>
  ServerName sustainablecorn.org
  ServerAlias www.sustainablecorn.org
  SSLEngine on
  # Set once in 000defaultvhost.conf
  # SSLProtocol all -SSLv2 -SSLv3
  # SSLCipherSuite ALL:!ADH:!EXPORT:!SSLv2:RC4+RSA:+HIGH:+MEDIUM:+LOW
  SSLCertificateKeyFile /etc/letsencrypt/live/sustainablecorn.org/privkey.pem
  SSLCertificateChainFile /etc/letsencrypt/live/sustainablecorn.org/chain.pem
  SSLCertificateFile /etc/letsencrypt/live/sustainablecorn.org/cert.pem
  
  DocumentRoot /opt/sustainablecorn/htdocs
  # Use a daily deadicated log file, this avoids server reloads every day
  # which are not much fun when servicing a 1,000 req/sec
  CustomLog "|/usr/sbin/rotatelogs -l /mesonet/www/logs/sustainablecorn-%Y%m%d 86400" combined

  ServerAdmin akrherz@iastate.edu
  Alias /usage/ "/mesonet/share/usage/sustainablecorn.org/"

  # RewriteEngine on 
  # RewriteRule ^/blog$ /blog/ [R]
  # ProxyPass /blog/ http://192.168.0.22/blog/
  # ProxyPassReverse /blog/ http://192.168.0.22/blog/

  <Directory "/mesonet/share/usage/sustainablecorn.org/">
    Options Indexes MultiViews
    AllowOverride None
    Order allow,deny
    Allow from all
  </Directory>
  <Directory "/opt/sustainablecorn/htdocs">
    Options Indexes MultiViews FollowSymLinks
    AllowOverride All
  </Directory>
  
</VirtualHost>

